<!DOCTYPE html>
<html lang="ru"
        xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="jakarta.faces.core"
      xmlns:h="jakarta.faces.html"
        xmlns:ui="jakarta.faces.facelets">
<f:view>
    <h:head>
        <title>HitChecker</title>
        <h:outputStylesheet library="css" name="styles.css" />
        <h:outputScript library="js" name="app.js" target="body" />
    </h:head>

    <h:body>
        <div id="notifications-container"></div>
        
        <header>
            <div class="header-left">
                <h1>–î—è–¥–µ–≤ –í–ª–∞–¥–∏—Å–ª–∞–≤ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á ‚Ä¢ P3231 ‚Ä¢ –í–∞—Ä–∏–∞–Ω—Ç 3465</h1>
            </div>
            <div class="header-right">
                <h:link outcome="index" value="‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é" styleClass="btn-link" />
            </div>
        </header>

        <main>
            <div class="top-section">
                <section class="controls">
                    <h:form id="coordsForm">

                        <!-- –í—ã–±–æ—Ä R -->
                        <div class="form-group" id="rGroup">
                            <label>R:</label>
                            <div class="r-option">
                                <h:selectBooleanCheckbox id="r1" value="#{pointCheckBean.zero}" />
                                <label for="r1">1</label>
                            </div>
                            <div class="r-option">
                                <h:selectBooleanCheckbox id="r1_5" value="#{pointCheckBean.one}" />
                                <label for="r1_5">1.5</label>
                            </div>
                            <div class="r-option">
                                <h:selectBooleanCheckbox id="r2" value="#{pointCheckBean.two}" />
                                <label for="r2">2</label>
                            </div>
                            <div class="r-option">
                                <h:selectBooleanCheckbox id="r2_5" value="#{pointCheckBean.three}" />
                                <label for="r2_5">2.5</label>
                            </div>
                            <div class="r-option">
                                <h:selectBooleanCheckbox id="r3" value="#{pointCheckBean.four}" />
                                <label for="r3">3</label>
                            </div>
                        </div>

                        <!-- –í–≤–æ–¥ X -->
                        <div class="form-group" id="xGroup">
                            <label for="xInput">X:</label>
                            <h:inputText id="xInput" value="#{pointCheckBean.selectedX}" required="true">
                                <f:passThroughAttribute name="placeholder" value="-3 ... 5" />
                            </h:inputText>
                        </div>

                        <!-- –ö–Ω–æ–ø–∫–∏ Y -->
                        <div class="form-group">
                            <label>Y (–Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã):</label>
                            <div class="y-buttons">
                                <h:commandButton value="-3" action="#{pointCheckBean.submitForm(-3)}" styleClass="btn">
                                    <f:ajax execute="@form" render=":jsf-errors-container :history-table-panel" />
                                </h:commandButton>
                                <h:commandButton value="-2" action="#{pointCheckBean.submitForm(-2)}" styleClass="btn">
                                    <f:ajax execute="@form" render=":jsf-errors-container :history-table-panel" />
                                </h:commandButton>
                                <h:commandButton value="-1" action="#{pointCheckBean.submitForm(-1)}" styleClass="btn">
                                    <f:ajax execute="@form" render=":jsf-errors-container :history-table-panel" />
                                </h:commandButton>
                                <h:commandButton value="0" action="#{pointCheckBean.submitForm(0)}" styleClass="btn">
                                    <f:ajax execute="@form" render=":jsf-errors-container :history-table-panel" />
                                </h:commandButton>
                                <h:commandButton value="1" action="#{pointCheckBean.submitForm(1)}" styleClass="btn">
                                    <f:ajax execute="@form" render=":jsf-errors-container :history-table-panel" />
                                </h:commandButton>
                                <h:commandButton value="2" action="#{pointCheckBean.submitForm(2)}" styleClass="btn">
                                    <f:ajax execute="@form" render=":jsf-errors-container :history-table-panel" />
                                </h:commandButton>
                                <h:commandButton value="3" action="#{pointCheckBean.submitForm(3)}" styleClass="btn">
                                    <f:ajax execute="@form" render=":jsf-errors-container :history-table-panel" />
                                </h:commandButton>
                                <h:commandButton value="4" action="#{pointCheckBean.submitForm(4)}" styleClass="btn">
                                    <f:ajax execute="@form" render=":jsf-errors-container :history-table-panel" />
                                </h:commandButton>
                                <h:commandButton value="5" action="#{pointCheckBean.submitForm(5)}" styleClass="btn">
                                    <f:ajax execute="@form" render=":jsf-errors-container :history-table-panel" />
                                </h:commandButton>
                            </div>
                        </div>

                        <!-- –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö JSF -->
                        <div class="jsf-errors-container" id="jsf-errors-container">
                            <h:messages id="msgs" layout="table" styleClass="jsf-error-message" />
                        </div>

                        <!-- –°–∫—Ä—ã—Ç—ã–µ –ø–æ–ª—è –¥–ª—è –∫–ª–∏–∫–∞ –ø–æ –≥—Ä–∞—Ñ–∏–∫—É -->
                        <h:inputHidden id="graphX" value="#{pointCheckBean.graphX}" />
                        <h:inputHidden id="graphY" value="#{pointCheckBean.graphY}" />
                        <h:inputHidden id="graphR" value="#{pointCheckBean.graphR}" />
                        <h:commandButton id="graphSubmit" action="#{pointCheckBean.submitFromGraph()}" style="display: none;">
                            <!-- Execute only hidden graph inputs to avoid validating other fields like X when submitting from canvas -->
                            <f:ajax execute="graphX graphY graphR" render=":jsf-errors-container :history-table-panel" />
                        </h:commandButton>

                    </h:form>
                </section>

                <section class="graph">
                    <canvas id="graph"></canvas>
                </section>
            </div>

            <section class="history">
                <div class="history-header">
                    <h2>–ò—Å—Ç–æ—Ä–∏—è –ø–æ–ø–∞–¥–∞–Ω–∏–π</h2>
                    <h:form>
                        <h:commandButton value="üóë –û—á–∏—Å—Ç–∏—Ç—å" action="#{historyBean.clearAll()}" styleClass="btn">
                            <f:ajax execute="@this" render=":history-table-panel" />
                        </h:commandButton>
                    </h:form>
                </div>

                <h:panelGroup id="history-table-panel">
                    <div class="history-table-wrapper" id="history-table-wrapper">
                        <table id="history-table">
                            <thead>
                                <tr>
                                    <th>–í—Ä–µ–º—è</th>
                                    <th>–†–µ–∑—É–ª—å—Ç–∞—Ç</th>
                                    <th>X</th>
                                    <th>Y</th>
                                    <th>R</th>
                                    <th>–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–º—Å)</th>
                                </tr>
                            </thead>
                            <tbody id="history-table-body">
                                <ui:repeat value="#{historyBean.entries}" var="entry" id="history-repeat">
                                    <tr class="history-item #{entry.result() ? 'hit' : 'miss'}" data-session-id="#{entry.sessionId()}">
                                        <td>#{entry.timestamp()}</td>
                                        <td>#{entry.result() ? '–ü–æ–ø–∞–ª üéØ' : '–ú–∏–º–æ ‚ùå'}</td>
                                        <td>#{entry.point().x()}</td>
                                        <td>#{entry.point().y()}</td>
                                        <td>#{entry.point().r()}</td>
                                            <td>#{entry.execTime()}</td>
                                    </tr>
                                </ui:repeat>
                                <!-- –°—Ç–∞—Ç–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä–æ–∫–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, —á—Ç–æ–±—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–µ–ª "–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞" —Å—Ä–∞–∑—É –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ.
                                     JS –∫–æ–¥ —É–¥–∞–ª–∏—Ç —ç—Ç—É —Å—Ç—Ä–æ–∫—É, –∫–∞–∫ —Ç–æ–ª—å–∫–æ –ø–æ—è–≤—è—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏ —Å –∫–ª–∞—Å—Å–æ–º .history-item -->
                                <tr class="history-empty">
                                    <td colspan="6" style="text-align: center; padding: 2rem;">–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞</td>
                                </tr>
                                <ui:fragment rendered="#{empty historyBean.entries}">
                                    <!-- –°–µ—Ä–≤–µ—Ä–Ω—ã–π fallback ‚Äî –æ—Å—Ç–∞–≤–ª–µ–Ω –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ -->
                                </ui:fragment>
                            </tbody>
                        </table>
                    </div>
                </h:panelGroup>
            </section>
        </main>
    <!-- Fallback script in case JSF didn't render body script correctly -->
    <script type="text/javascript" src="#{request.contextPath}/resources/js/app.js"></script>
    </h:body>
</f:view>
</html>